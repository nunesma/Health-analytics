install.packages(c("CDM", "DescTools", "fansi", "icd", "ipred", "JuliaCall", "lme4", "mirt", "pkgconfig", "processx", "rattle", "RcppArmadillo", "rlang", "rpart.plot", "sandwich", "stringi"))
install.packages(c("icd", "lme4", "stringi"))
install.packages(c("icd", "lme4", "stringi", "VGAM", "XML"))
install.packages(c("callr", "car", "chron", "clue"))
install.packages(c("digest", "doBy", "Epi", "epiR"))
install.packages(c("jomo", "later", "lme4", "micemd", "plotrix", "R.rsp"))
install.packages(c("R.utils", "stringi", "VGAM", "wordcloud", "XML"))
install.packages(c("stringi", "tinytex", "xtable", "xts"))
install.packages(c("digest", "icd", "plotmo", "pls", "stringi", "xts"))
install.packages(c("ape", "asbio", "carData", "CDM", "cli", "commonmark"))
install.packages(c("CDM", "commonmark", "covr", "data.table", "digest", "expm", "flexclust", "htmlwidgets"))
install.packages(c("later", "lavaan", "magic", "maptools", "MCMCpack", "miceadds", "nloptr"))
install.packages(c("OpenMx", "optimx", "pkgbuild", "pROC", "robustbase", "semTools"))
install.packages(c("spData", "stringi", "TAM", "TTR", "units", "webshot", "xts", "zoo"))
install.packages(c("CDM", "commonmark", "data.table", "nloptr", "stringi", "TAM"))
install.packages(c("antiword", "CDM", "coda", "commonmark", "data.table", "digest", "evaluate", "fansi", "gamlss", "gamlss.data", "gamlss.dist", "magick", "mime", "nloptr", "OpenMx", "plotrix", "pmml", "R6", "Rcpp", "rstudioapi", "rticles", "StanHeaders", "stringi", "TAM"))
install.packages(c("digest", "rticles", "stringi"))
install.packages(c("digest", "rticles", "stringi", "sysfonts", "tidyselect"))
install.packages(c("digest", "stringi", "sysfonts", "tidyselect"))
setwd("C:/Users/nunes/AI/ml/Health-analytics/med_std/explore")
library(FSA)
library(reshape)
library(prais)
# banco = read.csv("def1.csv")
def = read.csv("def.csv")
banco <- subset(def, status == "ATIVO" | status == "CONCLUÍDO" | status == "FORMANDO")
# Preparing dataset
banco$sex <- ifelse(banco$sexo == "F","Female","Male"); banco$sex <- as.factor(banco$sex)
banco$Sergipe <- ifelse(banco$uf_naturalidade == "SE","Yes","No"); banco$Sergipe <- as.factor(banco$Sergipe)
banco$concluded <- ifelse(banco$status == "CONCLUÍDO","Yes","No"); banco$concluded <- as.factor(banco$concluded)
banco$quotas <- ifelse(banco$ano_ingresso >= 2010 & (banco$cota=="B"|banco$cota=="C"|banco$cota=="D1"|banco$cota=="D2"|
banco$cota=="D3"|banco$cota=="D4"|banco$cota=="E"|
banco$cota=="F"|banco$cota=="G"|banco$cota=="H"|
banco$cota=="I"|banco$cota=="PD"),"Yes","No")
banco$periodo_ingresso <- banco$periodo_ingresso * 0.1
banco$entry_semester <- banco$ano_ingresso + banco$periodo_ingresso
banco$aproved <- banco$APROVADO + banco$DISPENSADO
banco$quotas <- as.factor(banco$quotas)
banco$reproved <- banco$REP..FALTA + banco$REPROVADO + banco$REPROVADO.POR.MÉDIA.E.POR.FALTAS
banco$equivalence <- banco$DISPENSADO
banco <- banco[c("matricula", "nome", "Idade_no_ingresso", "ano_ingresso", "entry_semester", "ano_integralizacao","sex", "Sergipe", "uf_naturalidade", "pais_naturalidade", "quotas", "n_periodos", "nota_med", "aproved", "reproved", "equivalence", "quit1", "quit2", "concluded")]
colnames(banco) <- c("registration", "name", "admission_age", "entry_year", "entry_semester",  "conclusion_year",
"sex", "Sergipe", "naturalness", "nationality", "quotas", "n_periods", "avg_note", "aproved",
"reproved", "equivalence", "quit1", "quit2", "concluded")
banco$quit2 <- banco$CANCELADO + banco$DESISTENCIA + banco$EXCLUIDA + banco$TRANCADO
banco$quit1 <- banco$TRANCADO
tapply(banco$aproved, banco$concluded, mean)
Summarize(banco$aproved)
hist(banco$aproved)
banco$quit2 <- banco$CANCELADO + banco$DESISTENCIA + banco$EXCLUIDA + banco$TRANCADO
# banco = read.csv("def1.csv")
def = read.csv("def.csv")
banco <- subset(def, status == "ATIVO" | status == "CONCLUÍDO" | status == "FORMANDO")
# Preparing dataset
banco$sex <- ifelse(banco$sexo == "F","Female","Male"); banco$sex <- as.factor(banco$sex)
banco$Sergipe <- ifelse(banco$uf_naturalidade == "SE","Yes","No"); banco$Sergipe <- as.factor(banco$Sergipe)
banco$concluded <- ifelse(banco$status == "CONCLUÍDO","Yes","No"); banco$concluded <- as.factor(banco$concluded)
banco$quotas <- ifelse(banco$ano_ingresso >= 2010 & (banco$cota=="B"|banco$cota=="C"|banco$cota=="D1"|banco$cota=="D2"|
banco$cota=="D3"|banco$cota=="D4"|banco$cota=="E"|
banco$cota=="F"|banco$cota=="G"|banco$cota=="H"|
banco$cota=="I"|banco$cota=="PD"),"Yes","No")
banco$periodo_ingresso <- banco$periodo_ingresso * 0.1
banco$entry_semester <- banco$ano_ingresso + banco$periodo_ingresso
banco$quotas <- as.factor(banco$quotas)
banco$aproved <- banco$APROVADO + banco$DISPENSADO
banco$quit2 <- banco$CANCELADO + banco$DESISTENCIA + banco$EXCLUIDA + banco$TRANCADO
banco$quit1 <- banco$TRANCADO
banco$reproved <- banco$REP..FALTA + banco$REPROVADO + banco$REPROVADO.POR.MÉDIA.E.POR.FALTAS
banco$equivalence <- banco$DISPENSADO
banco <- banco[c("matricula", "nome", "Idade_no_ingresso", "ano_ingresso", "entry_semester", "ano_integralizacao","sex", "Sergipe", "uf_naturalidade", "pais_naturalidade", "quotas", "n_periodos", "nota_med", "aproved", "reproved", "equivalence", "quit1", "quit2", "concluded")]
colnames(banco) <- c("registration", "name", "admission_age", "entry_year", "entry_semester",  "conclusion_year",
"sex", "Sergipe", "naturalness", "nationality", "quotas", "n_periods", "avg_note", "aproved",
"reproved", "equivalence", "quit1", "quit2", "concluded")
tapply(banco$aproved, banco$concluded, mean)
ind_reproved <- data.frame(tapply(banco$reproved, banco$entry_semester, mean))
ind_reproved
sex_series <- data.frame(table(banco$entry_semester,banco$sex))
sex_series <- cast(sex_series, Var1 ~ Var2, value = 'Freq')
sex_series$sem <- as.numeric(as.character(sex_series$Var1))
plot(ind_reroved$tapply.banco.reproved..banco.entry_semester..mean. ~ sex_series$sem, i_aproved, type = "l", ylim = c(0.0, 7.0))
plot(ind_reroved$tapply.banco.reproved..banco.entry_semester..mean. ~ sex_series$sem, type = "l", ylim = c(0.0, 7.0))
plot(ind_reproved$tapply.banco.reproved..banco.entry_semester..mean. ~ sex_series$sem, type = "l", ylim = c(0.0, 7.0))
plot(ind_reproved$tapply.banco.reproved..banco.entry_semester..mean. ~ sex_series$sem, type = "l", ylim = c(0.0, 1.0))
correction <- c(12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1)
coreaproved <- ind_reproved$tapply.banco.reproved..banco.entry_semester..mean./correction
cor_aproved
cor_reproved
correaproved
coreaproved
i_reproved <- data.frame(sex_series$sem, coreaproved)
colnames(i_reproved) <- c("sem", "aproved")
colnames(i_reproved) <- c("sem", "reproved")
plot(reproved ~ sem, i_aproved, type = "l", ylim = c(0.0, 7.0))
plot(reproved ~ sem, i_reproved, type = "l", ylim = c(0.0, 7.0))
plot(reproved ~ sem, i_reproved, type = "l", ylim = c(0.0, 1.0))
plot(reproved ~ sem, i_reproved, type = "l", ylim = c(0.0, 0.5))
plot(reproved ~ sem, i_reproved, type = "l", ylim = c(0.0, 0.2))
grid() # Draw gridlines
f3 <- rep(1/3, 3)# average of current sample and 2 previous samples (green)
f4 <- rep(1/4, 4)# average of current sample and 3 previous samples (blue)
y_lag3 <- filter(i_reproved$reproved, f3, sides=1)
y_lag4 <- filter(i_reproved$reproved, f4, sides=1)
lines(sex_series$sem, y_lag3, col="green") # calculating a moving average
lines(sex_series$sem, y_lag4, col="blue", lwd = 6) # calculating a moving average
### equivalence
ind_equivalence <- data.frame(tapply(banco$equivalence, banco$entry_semester, mean))
plot(ind_equivalence$tapply.banco.equivalence..banco.entry_semester..mean. ~ sex_series$sem, type = "l", ylim = c(0.0, 1.0))
plot(ind_equivalence$tapply.banco.equivalence..banco.entry_semester..mean. ~ sex_series$sem, type = "l", ylim = c(0.0, 3.0))
plot(ind_equivalence$tapply.banco.equivalence..banco.entry_semester..mean. ~ sex_series$sem, type = "l", ylim = c(0.0, 5.0))
plot(ind_equivalence$tapply.banco.equivalence..banco.entry_semester..mean. ~ sex_series$sem, type = "l", ylim = c(0.0, 7.0))
cor_equivalence <- ind_equivalence$tapply.banco.equivalence..banco.entry_semester..mean./correction
cor_equivalence
i_equivalence <- data.frame(sex_series$sem, cor_equivalence)
colnames(i_equivalence) <- c("sem", "equivalence")
plot(equivalence ~ sem, i_equivalence, type = "l", ylim = c(0.0, 4.0))
plot(equivalence[-1] ~ sem, i_equivalence, type = "l", ylim = c(0.0, 4.0))
plot(equivalence[:-1] ~ sem, i_equivalence, type = "l", ylim = c(0.0, 4.0))
plot(equivalence[-2016.2] ~ sem, i_equivalence, type = "l", ylim = c(0.0, 4.0))
plot(equivalence[-c(2016.2, 2016.1)] ~ sem, i_equivalence, type = "l", ylim = c(0.0, 4.0))
i_equivalence <- data.frame(sex_series$sem, ind_equivalence$tapply.banco.equivalence..banco.entry_semester..mean.)
colnames(i_equivalence) <- c("sem", "equivalence")
plot(equivalence ~ sem, i_equivalence, type = "l", ylim = c(0.0, 4.0))
plot(equivalence ~ sem, i_equivalence, type = "l", ylim = c(0.0, 7.0))
grid() # Draw gridlines
f3 <- rep(1/3, 3)# average of current sample and 2 previous samples (green)
f4 <- rep(1/4, 4)# average of current sample and 3 previous samples (blue)
y_lag3 <- filter(i_equivalence$equivalence, f3, sides=1)
y_lag4 <- filter(i_equivalence$equivalence, f4, sides=1)
lines(sex_series$sem, y_lag3, col="green") # calculating a moving average
lines(sex_series$sem, y_lag4, col="blue", lwd = 6) # calculating a moving average
